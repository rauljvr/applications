# Test for QTech Games

This Rest API provides the services to manage the online casino and its network of players.
<br>

## Septup

* ***Spring Boot***: 3.5.3
* ***JRE***: 17.0.12
* ***Maven***: 3.9.5

## Database

  This Spring Boot Application uses H2 as an In-Memory relational Database for testing purposes since is a lightweight database and requires low configuration.

  After starting the application you can go on http://localhost:8080/h2 where you can find a UI to check the databae. To log in set these parameters and click on "Connect":

* ***Driver Class***: org.h2.Driver
* ***JDBC URL***: jdbc:h2:mem:rollerdb
* ***User Name***: sa
* ***Password***: 
<br><br>

  ##### Table: Roller 
  * id: unique number (Autogenerated sequence)
  * name: player name (String)
  * parent_id: current parent node (id)
  * referral_chain: keep the referral IDs history (String)
  * exit: indicates whether the player left the network or not (Boolean)

#### <span style="color:orange"> Notes:

* Take into account that this database was configured to be volatile (it can be changed in the JDBC URL) and results in data loss after application restart. If you want you can change the initial data load by modifying the data.sql placed in the resources folder.
* All input data will be handled and saved in capital letters in the database. Therefore, the player's name is not case sensitive.</span>

## Starting the application locally at the root folder of the project

> ### Build
>```bash
>./mvnw install
>```

> ### Run 
>```bash
>./mvnw spring-boot:run
>```
> This will run the application locally on port 8080
<br>

## Testing the Application

In this application was included OpenAPI 3 for documentation and testing purposes (Swagger UI). <br>
Once the application is running you can go on http://localhost:8080/swagger-ui/index.html to start testring the operations.
<br>

### REST API endpoints:

* ***GET***: <span style="color:gray">http://localhost:8080/rollernetwork/roller/{id} </span>
  <br>Operation to get the player's info by his ID, regardless of whether the player left the network or not<br><br>

* ***GET***: <span style="color:gray">http://localhost:8080/rollernetwork/roller </span>
  <br>Operation to get the player's info by his name (Request parameter), regardless of whether the player left the network or not. 
  You can also check the referral chain of the player.<br><br>

* ***GET***: <span style="color:gray">http://localhost:8080/rollernetwork/roller/{name}/referral </span>
  <br>Operation to get who originally brought whom to the casino. The player has to be part of the network.<br><br>

* ***GET***: <span style="color:gray">http://localhost:8080/rollernetwork/roller/{name}/downline </span>
  <br>Operation to see the entire network downline of a player. The player has to be part of the network.<br><br>

* ***POST***: <span style="color:gray">http://localhost:8080/rollernetwork/roller </span>
  <br>Operation to add new players under their referrers.<br><br>
  Body example: { "name": "Player T", "parentName": "Player C"}<br><br>

* ***PUT***: <span style="color:gray">http://localhost:8080/rollernetwork/roller/{name}/exit </span>
  <br>Operation for players to leave the network. If a player leaves the network, the exit flag sets true and all players in his downline get his parent player.<br><br>

* ***PUT***: <span style="color:gray">http://localhost:8080/rollernetwork/roller/{name}/transfer </span>
  <br>Operation to transfer players between different VIP hosts. <br>
  The player's parent will be updated and the new parent is added to the tracking history.<br><br>
  Body example: { "name": "Player F"}<br><br>

### Postman collection

In addition to this, in the resources folder of the project you can find the Postman collection (v2.1) to test all operations.
